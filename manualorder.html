<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Dhito Cafe - Kasir Mode</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="menuorder.css">

<style>
body{
background:#0f172a;
}
.pos-header{
padding:20px;
font-weight:700;
font-size:18px;
text-align:center;
background:rgba(255,255,255,0.05);
backdrop-filter:blur(20px);
}
.checkout-btn{
background:#16a34a !important;
}
</style>
</head>

<body>

<div class="pos-header">
ðŸ–¥ Kasir Mode â€” Dhito Cafe
</div>

<div class="search-container">
<input type="text" id="searchInput" placeholder="Cari menu...">
</div>

<div class="categories">
<button onclick="filterMenu('all',this)" class="active">Semua</button>
<button onclick="filterMenu('makanan',this)">Makanan</button>
<button onclick="filterMenu('minuman',this)">Minuman</button>
<button onclick="filterMenu('cemilan',this)">Cemilan</button>
<button onclick="filterMenu('promo',this)">Promo</button>
</div>

<div class="menu-grid" id="menu"></div>

<div class="floating-cart" onclick="openSheet()">
ðŸ›’
<div class="cart-count" id="cartCount">0</div>
</div>

<div class="sheet" id="sheet">
<div class="handle"></div>

<h3>Detail Pesanan (Kasir)</h3>
<div id="cartItems"></div>

<div class="checkout-summary">
<div class="summary-row">
<span>Subtotal</span>
<span id="subtotal"></span>
</div>
<div class="summary-row">
<span>Service (5%)</span>
<span id="service"></span>
</div>
<div class="summary-row">
<span>Pajak (10%)</span>
<span id="tax"></span>
</div>

<div class="summary-divider"></div>

<div class="summary-row total-row">
<span>Total</span>
<span id="grandTotal"></span>
</div>
</div>

<button class="checkout-btn" onclick="checkoutManual()">
Bayar & Cetak
</button>

</div>

<div class="menu-modal" id="menuModal">
<div class="menu-modal-content">

<div class="modal-handle" onclick="closeMenuModal()"></div>

<div class="menu-modal-img" id="modalImg"></div>

<div class="menu-modal-body">
<h2 id="modalTitle"></h2>
<p id="modalDesc"></p>

<div class="topping-section">
<h4>Pilih Topping</h4>
<div class="topping-list" id="toppingList"></div>
</div>

<div class="modal-qty">
<button onclick="decreaseModal()">âˆ’</button>
<span id="modalQty">1</span>
<button onclick="increaseModal()">+</button>
</div>

<div class="modal-price" id="modalPrice"></div>

<button class="modal-add" id="modalAddBtn">
Tambah ke Keranjang
</button>

</div>
</div>
</div>

<div class="invoice-modal" id="invoiceModal">
<div class="invoice-content">
<div class="modal-handle" onclick="closeInvoice()"></div>
<h3>Invoice</h3>
<div id="invoiceBody"></div>
</div>
</div>

<script src="daftarmenu.js"></script>

<script>

const data = MENU_DATA;
const toppingsData = TOPPINGS_DATA;

let cart=[];
let selectedToppings=[];
let modalQty=1;
let orderHistory = JSON.parse(localStorage.getItem("order_history")||"[]");

/* ===== RENDER MENU ===== */

function render(){
let menu=document.getElementById("menu");
menu.innerHTML=data.map(d=>`
<div class="card" onclick="openMenuDetail('${d.nama}')">
<img src="${d.img}">
<h4>${d.nama}</h4>
<div class="price">Rp ${d.harga.toLocaleString()}</div>
</div>
`).join("");
}

render();

/* ===== CHECKOUT MANUAL ===== */

function checkoutManual(){

if(cart.length===0){
alert("Keranjang kosong");
return;
}

let subtotal=0;
cart.forEach(i=>subtotal+=i.harga*i.qty);

let service=subtotal*0.05;
let tax=subtotal*0.1;
let total=subtotal+service+tax;

let order={
id:"#POS-"+Date.now(),
date:new Date().toLocaleString(),
items:[...cart],
subtotal,
service,
tax,
total,
paymentMethod:"KASIR",
paymentStatus:"Lunas",
orderStatus:"Selesai",
customerName:"Walk In",
customerPhone:"-"
};

orderHistory.unshift(order);
localStorage.setItem("order_history",JSON.stringify(orderHistory));

cart=[];
updateCart();

openInvoice(order);

}

/* ===== OPEN INVOICE ===== */

function openInvoice(order){

document.getElementById("invoiceBody").innerHTML=`
<p><strong>${order.id}</strong></p>
<p>${order.date}</p>
<hr>
${order.items.map(i=>
`<p>${i.nama} (${i.qty}x)</p>`
).join("")}
<hr>
<p>Total: Rp ${order.total.toLocaleString()}</p>
`;

document.getElementById("invoiceModal").classList.add("show");
}

function closeInvoice(){
document.getElementById("invoiceModal").classList.remove("show");
}

/* ===== CART BASIC ===== */

function openMenuDetail(n){
let item=data.find(d=>d.nama===n);
cart.push({nama:item.nama,harga:item.harga,qty:1});
updateCart();
}

function updateCart(){
let subtotal=0;
document.getElementById("cartItems").innerHTML=
cart.map(i=>{
subtotal+=i.harga*i.qty;
return `<div>${i.nama} (${i.qty}x)</div>`;
}).join("");

let service=subtotal*0.05;
let tax=subtotal*0.1;
let total=subtotal+service+tax;

document.getElementById("subtotal").innerText="Rp "+subtotal.toLocaleString();
document.getElementById("service").innerText="Rp "+service.toLocaleString();
document.getElementById("tax").innerText="Rp "+tax.toLocaleString();
document.getElementById("grandTotal").innerText="Rp "+total.toLocaleString();
document.getElementById("cartCount").innerText=
cart.reduce((a,b)=>a+b.qty,0);
}

function openSheet(){
document.getElementById("sheet").classList.add("show");
}

</script>

</body>
</html>